@page
@model RefinanceModel
@{
    ViewData["Title"] = "Калкулатор за рефинансиране на кредит";
}

<h2>Калкулатор за рефинансиране на кредит</h2>
<p>Пресметнете дали рефинансирането на задълженията Ви е изгодно</p>

<form method="post" class="refinance-form">

    <h3>Настоящ кредит</h3>
    <div class="grid">
        <div>
            <label>Размер на кредита *</label>
            <input asp-for="CurrentAmount" type="number" step="0.01" required />
        </div>
        <div>
            <label>Лихва (%) *</label>
            <input asp-for="CurrentRate" type="number" step="0.01" required />
        </div>
        <div>
            <label>Срок на кредита (месеци) *</label>
            <input asp-for="CurrentMonths" type="number" required />
        </div>
        <div>
            <label>Брой на направените вноски *</label>
            <input asp-for="PaymentsMade" type="number" required />
        </div>
        <div>
            <label>Такса за предсрочно погасяване (%) *</label>
            <input asp-for="EarlyFee" type="number" step="0.01" required />
        </div>
    </div>

    <h3>Нов кредит</h3>
    <div class="grid">
        <div>
            <label>Лихва *</label>
            <input asp-for="NewRate" type="number" step="0.01" required />
        </div>
        <div>
            <label>Първоначални такси (%) *</label>
            <input asp-for="NewFeePercent" type="number" step="0.01" required />
        </div>
        <div>
            <label>Първоначални такси (валута) *</label>
            <input asp-for="NewFeeFixed" type="number" step="0.01" required />
        </div>
    </div>

    <button type="submit" class="btn">ИЗЧИСЛИ</button>
    <p class="note">* задължителни полета</p>
</form>

@if (Model.ShowResults)
{
    <h3>Резултати</h3>
    <table class="results">
        <thead>
            <tr>
                <th>Резултат</th>
                <th>Текущ кредит</th>
                <th>Нов кредит</th>
                <th>+/- Спестявания</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Лихва</td>
                <td>@Model.CurrentRate %</td>
                <td>@Model.NewRate %</td>
                <td></td>
            </tr>
            <tr>
                <td>Срокове на кредитите (месеци)</td>
                <td>@Model.CurrentMonths</td>
                <td>@Model.CurrentMonths</td>
                <td></td>
            </tr>
            <tr>
                <td>Такси</td>
                <td>@Model.EarlyFeeValue.ToString("F2") лв.</td>
                <td>@Model.NewFeeTotal.ToString("F2") лв.</td>
                <td></td>
            </tr>
            <tr>
                <td>Месечна вноска</td>
                <td>@Model.OldPayment.ToString("F2") лв.</td>
                <td>@Model.NewPayment.ToString("F2") лв.</td>
                <td>@(Model.NewPayment - Model.OldPayment).ToString("F2")</td>
            </tr>
            <tr>
                <td>Общо изплатени</td>
                <td>@Model.OldTotalCost.ToString("F2") лв.</td>
                <td>@Model.NewTotalCost.ToString("F2") лв.</td>
                <td>@Model.Saving.ToString("F2")</td>
            </tr>
        </tbody>
    </table>

    @if (Model.Saving > 0)
    {
        <div class="success">
             Рефинансирането е изгодно. Очакваната икономия е @Model.Saving.ToString("F2") лв.
        </div>
    }
    else
    {
        <div class="error">
             Въведените параметри показват, че избраната оферта за нов кредит не е изгодна.
            Цената на рефинансирането е по-висока от очакваната икономия.
        </div>
    }
}


